{"ast":null,"code":"import _classCallCheck from \"/Users/andrecampbell/Desktop/MaxBone/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/andrecampbell/Desktop/MaxBone/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport axios from \"axios\";\n\nvar LoginController =\n/*#__PURE__*/\nfunction () {\n  function LoginController() {\n    _classCallCheck(this, LoginController);\n\n    this.userChangedListeners = [];\n    this.user = null;\n  }\n\n  _createClass(LoginController, [{\n    key: \"login\",\n    value: function login(email, password, afterLoginCallback) {\n      var _this = this;\n\n      var postData = {\n        email: email,\n        password: password\n      };\n      axios.post(\"/api/Users/login\", postData).then(function (response) {\n        // Got here, we should have a cookie set and can go forward\n        console.log(\"User logged in\");\n        var user = response.data.user;\n\n        _this.setUser(user);\n\n        afterLoginCallback && afterLoginCallback(null, user);\n      }).catch(function (err) {\n        console.log(err); // The error might have come from the server, or thrown by the client\n\n        var errorMessage = err.response && err.response.data.error || \"Unable to login\";\n        afterLoginCallback(errorMessage, null);\n      });\n    } // Hit our API and validate our authentication information\n\n  }, {\n    key: \"recheckLogin\",\n    value: function recheckLogin(loginCallback) {\n      var _this2 = this;\n\n      axios.get(\"/api/Users/getUser\").then(function (response) {\n        var user = response.data || null; // console.log(user)\n\n        _this2.setUser(user);\n\n        loginCallback && loginCallback(user);\n      });\n    }\n  }, {\n    key: \"setUser\",\n    value: function setUser(user) {\n      this.user = user; // Go through all the listeners and notify them\n\n      this.userChangedListeners.forEach(function (listener) {\n        return listener(user);\n      });\n    }\n  }, {\n    key: \"logout\",\n    value: function logout(afterLogoutCallback) {\n      var _this3 = this;\n\n      axios.post(\"/api/Users/logout\").then(function (response) {\n        _this3.setUser(null);\n\n        afterLogoutCallback && afterLogoutCallback();\n      });\n    }\n  }, {\n    key: \"addUserChangedListener\",\n    value: function addUserChangedListener(listenerCallback) {\n      this.userChangedListeners.push(listenerCallback);\n    }\n  }, {\n    key: \"removeUserChangedListener\",\n    value: function removeUserChangedListener(listenerCallback) {\n      this.userChangedListeners = this.userChangedListeners.filter(function (l) {\n        return l !== listenerCallback;\n      });\n    }\n  }]);\n\n  return LoginController;\n}();\n\nexport default new LoginController();","map":{"version":3,"sources":["/Users/andrecampbell/Desktop/MaxBone/client/src/controllers/LoginController.js"],"names":["axios","LoginController","userChangedListeners","user","email","password","afterLoginCallback","postData","post","then","response","console","log","data","setUser","catch","err","errorMessage","error","loginCallback","get","forEach","listener","afterLogoutCallback","listenerCallback","push","filter","l"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;;IAEMC,e;;;;;;SAGFC,oB,GAAuB,E;SAEvBC,I,GAAO,I;;;;;0BAEDC,K,EAAOC,Q,EAAUC,kB,EAAoB;AAAA;;AACvC,UAAMC,QAAQ,GAAG;AAAEH,QAAAA,KAAK,EAAEA,KAAT;AAAgBC,QAAAA,QAAQ,EAAEA;AAA1B,OAAjB;AAEAL,MAAAA,KAAK,CAACQ,IAAN,CAAW,kBAAX,EAA+BD,QAA/B,EACKE,IADL,CACU,UAAAC,QAAQ,EAAI;AACd;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AAEA,YAAIT,IAAI,GAAGO,QAAQ,CAACG,IAAT,CAAcV,IAAzB;;AACA,QAAA,KAAI,CAACW,OAAL,CAAaX,IAAb;;AAEAG,QAAAA,kBAAkB,IAAIA,kBAAkB,CAAC,IAAD,EAAOH,IAAP,CAAxC;AACH,OATL,EAUKY,KAVL,CAUW,UAAAC,GAAG,EAAI;AACVL,QAAAA,OAAO,CAACC,GAAR,CAAYI,GAAZ,EADU,CAEV;;AACA,YAAIC,YAAY,GAAID,GAAG,CAACN,QAAJ,IAAgBM,GAAG,CAACN,QAAJ,CAAaG,IAAb,CAAkBK,KAAnC,IAA6C,iBAAhE;AAEAZ,QAAAA,kBAAkB,CAACW,YAAD,EAAe,IAAf,CAAlB;AACH,OAhBL;AAiBH,K,CAED;;;;iCACaE,a,EAAe;AAAA;;AACxBnB,MAAAA,KAAK,CAACoB,GAAN,CAAU,oBAAV,EAAgCX,IAAhC,CAAqC,UAAAC,QAAQ,EAAI;AAC7C,YAAIP,IAAI,GAAGO,QAAQ,CAACG,IAAT,IAAiB,IAA5B,CAD6C,CAE7C;;AAEA,QAAA,MAAI,CAACC,OAAL,CAAaX,IAAb;;AAEAgB,QAAAA,aAAa,IAAIA,aAAa,CAAChB,IAAD,CAA9B;AACH,OAPD;AAQH;;;4BAEOA,I,EAAM;AACV,WAAKA,IAAL,GAAYA,IAAZ,CADU,CAGV;;AACA,WAAKD,oBAAL,CAA0BmB,OAA1B,CAAkC,UAAAC,QAAQ;AAAA,eAAIA,QAAQ,CAACnB,IAAD,CAAZ;AAAA,OAA1C;AACH;;;2BAEMoB,mB,EAAqB;AAAA;;AACxBvB,MAAAA,KAAK,CAACQ,IAAN,CAAW,mBAAX,EAAgCC,IAAhC,CAAqC,UAAAC,QAAQ,EAAI;AAC7C,QAAA,MAAI,CAACI,OAAL,CAAa,IAAb;;AAEAS,QAAAA,mBAAmB,IAAIA,mBAAmB,EAA1C;AACH,OAJD;AAKH;;;2CAEsBC,gB,EAAkB;AACrC,WAAKtB,oBAAL,CAA0BuB,IAA1B,CAA+BD,gBAA/B;AACH;;;8CAEyBA,gB,EAAkB;AACxC,WAAKtB,oBAAL,GACI,KAAKA,oBAAL,CAA0BwB,MAA1B,CAAiC,UAAAC,CAAC;AAAA,eAAIA,CAAC,KAAKH,gBAAV;AAAA,OAAlC,CADJ;AAEH;;;;;;AAGL,eAAe,IAAIvB,eAAJ,EAAf","sourcesContent":["import axios from \"axios\";\n\nclass LoginController {\n    // This is a list of callbacks that are remembered for when the user changes. (login/logout)\n    \n    userChangedListeners = [];\n\n    user = null;\n\n    login(email, password, afterLoginCallback) {\n        const postData = { email: email, password: password };\n\n        axios.post(\"/api/Users/login\", postData)\n            .then(response => {\n                // Got here, we should have a cookie set and can go forward\n                console.log(\"User logged in\");\n\n                let user = response.data.user;\n                this.setUser(user);\n\n                afterLoginCallback && afterLoginCallback(null, user);\n            })\n            .catch(err => {\n                console.log(err);\n                // The error might have come from the server, or thrown by the client\n                let errorMessage = (err.response && err.response.data.error) || \"Unable to login\";\n\n                afterLoginCallback(errorMessage, null);\n            })\n    }\n\n    // Hit our API and validate our authentication information\n    recheckLogin(loginCallback) {\n        axios.get(\"/api/Users/getUser\").then(response => {\n            let user = response.data || null;\n            // console.log(user)\n\n            this.setUser(user);\n\n            loginCallback && loginCallback(user);\n        })\n    }\n\n    setUser(user) {\n        this.user = user;\n\n        // Go through all the listeners and notify them\n        this.userChangedListeners.forEach(listener => listener(user));\n    }\n\n    logout(afterLogoutCallback) {\n        axios.post(\"/api/Users/logout\").then(response => {\n            this.setUser(null);\n\n            afterLogoutCallback && afterLogoutCallback();\n        })\n    }\n\n    addUserChangedListener(listenerCallback) {\n        this.userChangedListeners.push(listenerCallback);\n    }\n\n    removeUserChangedListener(listenerCallback) {\n        this.userChangedListeners =\n            this.userChangedListeners.filter(l => l !== listenerCallback);\n    }\n}\n\nexport default new LoginController();"]},"metadata":{},"sourceType":"module"}